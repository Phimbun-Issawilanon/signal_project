classdef signal_rlc < matlab.apps.AppBase

    % Properties that correspond to app components
    properties (Access = public)
        UIFigure                        matlab.ui.Figure
        CurrentLabel                    matlab.ui.control.Label
        VoltageLabel                    matlab.ui.control.Label
        PhaseLabel                      matlab.ui.control.Label
        GainLabel                       matlab.ui.control.Label
        OutputWaveformVoltageCurrentLabel  matlab.ui.control.Label
        BodeDiagramGainPhaseLabel       matlab.ui.control.Label
        Image                           matlab.ui.control.Image
        dampingfactorEditFieldLabel_2   matlab.ui.control.Label
        mLabel                          matlab.ui.control.Label
        AmplitudeVoutSpinner            matlab.ui.control.Spinner
        AmplitudeVoutSpinnerLabel       matlab.ui.control.Label
        DropDown_5                      matlab.ui.control.DropDown
        FrequencySpinner                matlab.ui.control.Spinner
        FrequencySpinnerLabel           matlab.ui.control.Label
        dampname                        matlab.ui.control.TextArea
        OKButton                        matlab.ui.control.Button
        enddisplayEditField             matlab.ui.control.EditField
        enddisplayLabel                 matlab.ui.control.Label
        startdisplayEditField           matlab.ui.control.EditField
        startdisplayEditFieldLabel      matlab.ui.control.Label
        dampingfactorEditField          matlab.ui.control.EditField
        dampingfactorEditFieldLabel     matlab.ui.control.Label
        OLabel                          matlab.ui.control.Label
        radsLabel                       matlab.ui.control.Label
        phasemarginEditField            matlab.ui.control.EditField
        phasemarginEditFieldLabel       matlab.ui.control.Label
        propertiesLabel                 matlab.ui.control.Label
        AngularresonanceEditField       matlab.ui.control.EditField
        AngularresonanceEditFieldLabel  matlab.ui.control.Label
        VoutDropDown                    matlab.ui.control.DropDown
        VoutDropDownLabel               matlab.ui.control.Label
        CurcuitDropDown                 matlab.ui.control.DropDown
        CurcuitDropDownLabel            matlab.ui.control.Label
        signalDropDown                  matlab.ui.control.DropDown
        signalDropDownLabel             matlab.ui.control.Label
        DropDown_3                      matlab.ui.control.DropDown
        DropDown_2                      matlab.ui.control.DropDown
        CSpinner                        matlab.ui.control.Spinner
        CSpinnerLabel                   matlab.ui.control.Label
        LSpinner                        matlab.ui.control.Spinner
        LSpinnerLabel                   matlab.ui.control.Label
        RSpinner                        matlab.ui.control.Spinner
        RSpinnerLabel                   matlab.ui.control.Label
        DropDown                        matlab.ui.control.DropDown
        UIAxes2_3                       matlab.ui.control.UIAxes
        UIAxes2_4                       matlab.ui.control.UIAxes
        UIAxes2_2                       matlab.ui.control.UIAxes
        UIAxes2                         matlab.ui.control.UIAxes
    end



    % Callbacks that handle component events
    methods (Access = private)

        % Button pushed function: OKButton
        function OKButtonPushed(app, event)
            circuit = app.CurcuitDropDown.Value;
            r_unit = app.DropDown;
            l_unit = app.DropDown_2;
            c_unit = app.DropDown_3;
              if r_unit.Value == "mΩ"
               r = app.RSpinner.Value*10^-3;
            elseif r_unit.Value == "kΩ"
               r = app.RSpinner.Value*10^3;
               
            elseif r_unit.Value == "Ω"
               r = app.RSpinner.Value;
            end
            
            if l_unit.Value == "mH"
               l = app.LSpinner.Value*10^-3;
            elseif l_unit.Value == "uH"
               l = app.LSpinner.Value*10^-6;
            elseif l_unit.Value == "nH"
               l = app.LSpinner.Value*10^-9;
            elseif l_unit.Value == "H"
               l = app.LSpinner.Value;
            end
            
            if c_unit.Value == "F"
               c = app.CSpinner.Value;
            elseif c_unit.Value == "uF"
               c = app.CSpinner.Value*10^-6;
            elseif c_unit.Value == "nF"
               c = app.CSpinner.Value*10^-9;
            elseif c_unit.Value == "pF"
               c = app.CSpinner.Value*10^-12;
            end
            if circuit == "อนุกรม"
                damp = r/(2*l);
                w = 1/sqrt(l*c);
                check_case(app,damp,w);
            elseif circuit == "ขนาน"
                damp = 1/(2*r*c);
                w = 1/sqrt(l*c);
                check_case(app,damp,w);
            end
        function check_case(app,damp,w)
            if w < damp
                app.dampingfactorEditField.Value = "overdamped";
            elseif w == damp
                app.dampingfactorEditField.Value = "critical damped";
            elseif w > damp
                app.dampingfactorEditField.Value = "underdamped";
            end
        end
        end
    end

    % Component initialization
    methods (Access = private)

        % Create UIFigure and components
        function createComponents(app)

            % Create UIFigure and hide until all components are created
            app.UIFigure = uifigure('Visible', 'off');
            app.UIFigure.Position = [100 100 1033 822];
            app.UIFigure.Name = 'MATLAB App';

            % Create UIAxes2
            app.UIAxes2 = uiaxes(app.UIFigure);
            zlabel(app.UIAxes2, 'Z')
            app.UIAxes2.Position = [68 551 378 210];

            % Create UIAxes2_2
            app.UIAxes2_2 = uiaxes(app.UIFigure);
            zlabel(app.UIAxes2_2, 'Z')
            app.UIAxes2_2.Position = [581 551 391 210];

            % Create UIAxes2_4
            app.UIAxes2_4 = uiaxes(app.UIFigure);
            zlabel(app.UIAxes2_4, 'Z')
            app.UIAxes2_4.Position = [68 315 378 211];

            % Create UIAxes2_3
            app.UIAxes2_3 = uiaxes(app.UIFigure);
            zlabel(app.UIAxes2_3, 'Z')
            app.UIAxes2_3.Position = [581 322 391 204];

            % Create DropDown
            app.DropDown = uidropdown(app.UIFigure);
            app.DropDown.Items = {'Ω', 'mΩ', 'kΩ', ''};
            app.DropDown.Position = [221 203 54 22];
            app.DropDown.Value = 'Ω';

            % Create RSpinnerLabel
            app.RSpinnerLabel = uilabel(app.UIFigure);
            app.RSpinnerLabel.HorizontalAlignment = 'right';
            app.RSpinnerLabel.FontWeight = 'bold';
            app.RSpinnerLabel.Position = [61 203 25 22];
            app.RSpinnerLabel.Text = 'R';

            % Create RSpinner
            app.RSpinner = uispinner(app.UIFigure);
            app.RSpinner.Position = [94 203 100 22];

            % Create LSpinnerLabel
            app.LSpinnerLabel = uilabel(app.UIFigure);
            app.LSpinnerLabel.HorizontalAlignment = 'right';
            app.LSpinnerLabel.FontWeight = 'bold';
            app.LSpinnerLabel.Position = [60 164 25 22];
            app.LSpinnerLabel.Text = 'L';

            % Create LSpinner
            app.LSpinner = uispinner(app.UIFigure);
            app.LSpinner.Position = [94 164 100 22];

            % Create CSpinnerLabel
            app.CSpinnerLabel = uilabel(app.UIFigure);
            app.CSpinnerLabel.HorizontalAlignment = 'right';
            app.CSpinnerLabel.FontWeight = 'bold';
            app.CSpinnerLabel.Position = [61 128 25 22];
            app.CSpinnerLabel.Text = 'C';

            % Create CSpinner
            app.CSpinner = uispinner(app.UIFigure);
            app.CSpinner.Position = [95 128 100 22];

            % Create DropDown_2
            app.DropDown_2 = uidropdown(app.UIFigure);
            app.DropDown_2.Items = {'mH', 'uH', 'nH', 'H'};
            app.DropDown_2.Position = [221 169 54 22];
            app.DropDown_2.Value = 'H';

            % Create DropDown_3
            app.DropDown_3 = uidropdown(app.UIFigure);
            app.DropDown_3.Items = {'uF', 'F', 'nF', 'pF'};
            app.DropDown_3.Position = [221 128 54 22];
            app.DropDown_3.Value = 'F';

            % Create signalDropDownLabel
            app.signalDropDownLabel = uilabel(app.UIFigure);
            app.signalDropDownLabel.HorizontalAlignment = 'right';
            app.signalDropDownLabel.FontWeight = 'bold';
            app.signalDropDownLabel.Position = [360 235 40 22];
            app.signalDropDownLabel.Text = 'signal';

            % Create signalDropDown
            app.signalDropDown = uidropdown(app.UIFigure);
            app.signalDropDown.Items = {'ramp', 'sine', 'pulse'};
            app.signalDropDown.Position = [434 235 100 22];
            app.signalDropDown.Value = 'ramp';

            % Create CurcuitDropDownLabel
            app.CurcuitDropDownLabel = uilabel(app.UIFigure);
            app.CurcuitDropDownLabel.HorizontalAlignment = 'right';
            app.CurcuitDropDownLabel.FontWeight = 'bold';
            app.CurcuitDropDownLabel.Position = [68 239 47 22];
            app.CurcuitDropDownLabel.Text = 'Curcuit';

            % Create CurcuitDropDown
            app.CurcuitDropDown = uidropdown(app.UIFigure);
            app.CurcuitDropDown.Items = {'series', 'parallel', ''};
            app.CurcuitDropDown.Position = [137 239 100 22];
            app.CurcuitDropDown.Value = 'series';

            % Create VoutDropDownLabel
            app.VoutDropDownLabel = uilabel(app.UIFigure);
            app.VoutDropDownLabel.HorizontalAlignment = 'right';
            app.VoutDropDownLabel.FontWeight = 'bold';
            app.VoutDropDownLabel.Position = [365 128 31 22];
            app.VoutDropDownLabel.Text = 'Vout';

            % Create VoutDropDown
            app.VoutDropDown = uidropdown(app.UIFigure);
            app.VoutDropDown.Items = {'R', 'L', 'C'};
            app.VoutDropDown.Position = [436 128 100 22];
            app.VoutDropDown.Value = 'R';

            % Create AngularresonanceEditFieldLabel
            app.AngularresonanceEditFieldLabel = uilabel(app.UIFigure);
            app.AngularresonanceEditFieldLabel.HorizontalAlignment = 'right';
            app.AngularresonanceEditFieldLabel.FontWeight = 'bold';
            app.AngularresonanceEditFieldLabel.Position = [858 199 114 22];
            app.AngularresonanceEditFieldLabel.Text = 'Angular resonance';

            % Create AngularresonanceEditField
            app.AngularresonanceEditField = uieditfield(app.UIFigure, 'text');
            app.AngularresonanceEditField.Position = [887 172 63 22];

            % Create propertiesLabel
            app.propertiesLabel = uilabel(app.UIFigure);
            app.propertiesLabel.FontWeight = 'bold';
            app.propertiesLabel.Position = [891 235 64 22];
            app.propertiesLabel.Text = 'properties';

            % Create phasemarginEditFieldLabel
            app.phasemarginEditFieldLabel = uilabel(app.UIFigure);
            app.phasemarginEditFieldLabel.HorizontalAlignment = 'right';
            app.phasemarginEditFieldLabel.FontWeight = 'bold';
            app.phasemarginEditFieldLabel.Position = [864 139 83 22];
            app.phasemarginEditFieldLabel.Text = 'phase margin';

            % Create phasemarginEditField
            app.phasemarginEditField = uieditfield(app.UIFigure, 'text');
            app.phasemarginEditField.Position = [891 103 63 22];

            % Create radsLabel
            app.radsLabel = uilabel(app.UIFigure);
            app.radsLabel.Position = [971 172 32 22];
            app.radsLabel.Text = 'rad/s';

            % Create OLabel
            app.OLabel = uilabel(app.UIFigure);
            app.OLabel.Position = [971 113 13 20];
            app.OLabel.Text = 'O';

            % Create dampingfactorEditFieldLabel
            app.dampingfactorEditFieldLabel = uilabel(app.UIFigure);
            app.dampingfactorEditFieldLabel.HorizontalAlignment = 'right';
            app.dampingfactorEditFieldLabel.FontWeight = 'bold';
            app.dampingfactorEditFieldLabel.Position = [42 86 92 22];
            app.dampingfactorEditFieldLabel.Text = 'damping factor';

            % Create dampingfactorEditField
            app.dampingfactorEditField = uieditfield(app.UIFigure, 'text');
            app.dampingfactorEditField.Position = [141 86 126 22];

            % Create startdisplayEditFieldLabel
            app.startdisplayEditFieldLabel = uilabel(app.UIFigure);
            app.startdisplayEditFieldLabel.HorizontalAlignment = 'right';
            app.startdisplayEditFieldLabel.FontWeight = 'bold';
            app.startdisplayEditFieldLabel.Position = [346 86 76 22];
            app.startdisplayEditFieldLabel.Text = 'start display';

            % Create startdisplayEditField
            app.startdisplayEditField = uieditfield(app.UIFigure, 'text');
            app.startdisplayEditField.Position = [436 86 100 22];

            % Create enddisplayLabel
            app.enddisplayLabel = uilabel(app.UIFigure);
            app.enddisplayLabel.HorizontalAlignment = 'right';
            app.enddisplayLabel.FontWeight = 'bold';
            app.enddisplayLabel.Position = [346 44 71 22];
            app.enddisplayLabel.Text = 'end display';

            % Create enddisplayEditField
            app.enddisplayEditField = uieditfield(app.UIFigure, 'text');
            app.enddisplayEditField.Position = [436 44 100 22];

            % Create OKButton
            app.OKButton = uibutton(app.UIFigure, 'push');
            app.OKButton.ButtonPushedFcn = createCallbackFcn(app, @OKButtonPushed, true);
            app.OKButton.BackgroundColor = [0 1 0];
            app.OKButton.FontWeight = 'bold';
            app.OKButton.Position = [420 8 100 22];
            app.OKButton.Text = 'OK';

            % Create dampname
            app.dampname = uitextarea(app.UIFigure);
            app.dampname.Position = [141 46 126 24];

            % Create FrequencySpinnerLabel
            app.FrequencySpinnerLabel = uilabel(app.UIFigure);
            app.FrequencySpinnerLabel.HorizontalAlignment = 'right';
            app.FrequencySpinnerLabel.FontWeight = 'bold';
            app.FrequencySpinnerLabel.Position = [346 203 66 22];
            app.FrequencySpinnerLabel.Text = 'Frequency';

            % Create FrequencySpinner
            app.FrequencySpinner = uispinner(app.UIFigure);
            app.FrequencySpinner.Position = [433 203 100 22];

            % Create DropDown_5
            app.DropDown_5 = uidropdown(app.UIFigure);
            app.DropDown_5.Items = {'mHz', 'uHz', 'nHz', 'Hz'};
            app.DropDown_5.Position = [549 203 54 22];
            app.DropDown_5.Value = 'Hz';

            % Create AmplitudeVoutSpinnerLabel
            app.AmplitudeVoutSpinnerLabel = uilabel(app.UIFigure);
            app.AmplitudeVoutSpinnerLabel.HorizontalAlignment = 'right';
            app.AmplitudeVoutSpinnerLabel.FontWeight = 'bold';
            app.AmplitudeVoutSpinnerLabel.Position = [322 167 93 22];
            app.AmplitudeVoutSpinnerLabel.Text = 'Amplitude Vout';

            % Create AmplitudeVoutSpinner
            app.AmplitudeVoutSpinner = uispinner(app.UIFigure);
            app.AmplitudeVoutSpinner.Position = [435 167 98 22];

            % Create mLabel
            app.mLabel = uilabel(app.UIFigure);
            app.mLabel.Position = [549 167 25 22];
            app.mLabel.Text = 'm';

            % Create dampingfactorEditFieldLabel_2
            app.dampingfactorEditFieldLabel_2 = uilabel(app.UIFigure);
            app.dampingfactorEditFieldLabel_2.HorizontalAlignment = 'right';
            app.dampingfactorEditFieldLabel_2.FontWeight = 'bold';
            app.dampingfactorEditFieldLabel_2.Position = [48 44 83 22];
            app.dampingfactorEditFieldLabel_2.Text = 'Type of damp';

            % Create Image
            app.Image = uiimage(app.UIFigure);
            app.Image.Position = [573 86 308 167];

            % Create BodeDiagramGainPhaseLabel
            app.BodeDiagramGainPhaseLabel = uilabel(app.UIFigure);
            app.BodeDiagramGainPhaseLabel.BackgroundColor = [1 1 0.0667];
            app.BodeDiagramGainPhaseLabel.FontWeight = 'bold';
            app.BodeDiagramGainPhaseLabel.Position = [195 760 160 25];
            app.BodeDiagramGainPhaseLabel.Text = 'Bode Diagram(Gain,Phase)';

            % Create OutputWaveformVoltageCurrentLabel
            app.OutputWaveformVoltageCurrentLabel = uilabel(app.UIFigure);
            app.OutputWaveformVoltageCurrentLabel.BackgroundColor = [0.0588 1 1];
            app.OutputWaveformVoltageCurrentLabel.FontWeight = 'bold';
            app.OutputWaveformVoltageCurrentLabel.Position = [678 760 204 25];
            app.OutputWaveformVoltageCurrentLabel.Text = 'Output Waveform(Voltage,Current)';

            % Create GainLabel
            app.GainLabel = uilabel(app.UIFigure);
            app.GainLabel.FontWeight = 'bold';
            app.GainLabel.Position = [251 528 32 24];
            app.GainLabel.Text = 'Gain';

            % Create PhaseLabel
            app.PhaseLabel = uilabel(app.UIFigure);
            app.PhaseLabel.FontWeight = 'bold';
            app.PhaseLabel.Position = [247 292 42 24];
            app.PhaseLabel.Text = 'Phase';

            % Create VoltageLabel
            app.VoltageLabel = uilabel(app.UIFigure);
            app.VoltageLabel.FontWeight = 'bold';
            app.VoltageLabel.Position = [767 525 48 24];
            app.VoltageLabel.Text = 'Voltage';

            % Create CurrentLabel
            app.CurrentLabel = uilabel(app.UIFigure);
            app.CurrentLabel.FontWeight = 'bold';
            app.CurrentLabel.Position = [768 292 52 24];
            app.CurrentLabel.Text = 'Current';

            % Show the figure after all components are created
            app.UIFigure.Visible = 'on';
        end
    end

    % App creation and deletion
    methods (Access = public)

        % Construct app
        function app = signal_rlc

            % Create UIFigure and components
            createComponents(app)

            % Register the app with App Designer
            registerApp(app, app.UIFigure)

            if nargout == 0
                clear app
            end
        end

        % Code that executes before app deletion
        function delete(app)

            % Delete UIFigure when app is deleted
            delete(app.UIFigure)
        end
    end
end
